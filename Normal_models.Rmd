---
title: "Normal models"
author: "Put your name here"
date: "Put the date here"
output: pdf_document
---
<!-- Please don't mess with the next two lines! -->
\newenvironment{answer}{\definecolor{shadecolor}{RGB}{225, 225, 255}\begin{shaded}}{\end{shaded}}
<!-- Please don't mess with the previous two lines! -->


## Introduction

In this assignment we will learn how to work with normal models.


## Instructions

Presumably, you have already created a new project and downloaded this file into it. Please knit the document and work back and forth between this R Markdown file and the PDF output as you work through this module.

When you are finished with the assignment, knit to PDF one last time, proofread the PDF file **carefully**, export the PDF file to your computer, and then submit your assignment.

Sometimes you will be asked to add your own R code. That will appear in this document as a code chunk with a request for you to add your own code, like so:

```{r}
## Add code here to [do some task]...
```

Be sure to remove the line `## Add code here to [do some task]...` when you have added your own code.

Sometimes you will be asked to type up your thoughts. That will appear in the document as follows:

\begin{answer}
Please write up your answer here.
\end{answer}

Again, please be sure to remove the line "Please write up your answer here" when you have written up your answer. In these areas of the assignment, please use contextually meaningful full sentences/paragraphs (unless otherwise indicated) and proper spelling, grammar, punctuation, etc. This is not R code, but rather a free response section where you talk about your analysis and conclusions. If you need to use some R code as well, you can use inline R code inside the block between `\begin{answer}` and `\end{answer}`, or if you need an R code chunk, please go outside the `answer` block and start a new code chunk.


## Load Packages

We load the standard `mosaic` package.

```{r, message = FALSE, warning = FALSE}
library(mosaic)
```


## The Central Limit Theorem

An important aspect of all the simulations that we've done so far---assuming that we've run a large enough number of them---is that their histograms all look like bell curves. This fact is known as the "Central Limit Theorem". Under some basic assumptions that we'll discuss in a later assignment, this will be typical of all our simulated null distributions. 

So rather than running a simulation each time we want to conduct a hypotheses test, we could also assume that the null distribution *is* a bell curve. The rest of this assignment will teach you how to work with the "normal distribution", which is just the mathematically correct term for a bell curve.


## Normal models

The normal distribution looks like this:

```{r}
# Don't worry about the syntax here.
# You won't need to know how to do this on your own.

ggplot(data.frame(x = c(-4, 4)), aes(x)) +
    stat_function(fun = dnorm) +
    scale_x_continuous(breaks = -3:3)
```

The curve pictured above is called the *standard normal distribution*. It has a mean of 0 and a standard deviation of 1. Mathematically, this is often written as

$$N( \mu = 0, \sigma = 1),$$

or sometimes just

$$N(0, 1).$$

We use this bell curve shape to model data that is unimodal, symmetric, and without outliers. A statistical "model" is a simplification or an idealization. Reality is, of course, never perfectly bell-shaped. Real data is not exactly symmetric with one clear peak in the middle. Nevertheless, an abstract model can give us good answers if used properly.

As an example of this, systolic blood pressure (SBP, measured in millimeters of mercury, or mmHg) is more-or-less normally distributed in women ages 30--44 in the U.S. and Canada, with a mean of 114 and a standard deviation of 14.^[Statistics from the World Health Organization: http://www.who.int/publications/cra/chapters/volume1/0281-0390.pdf]

If we were to plot a histogram with the SBP of every woman between the ages of 30 and 44 in the U.S. and Canada, it would have the shape of a normal distribution, but instead of being centered at 0 like the graph above, this one would be centered at 114. Mathematically, we write

$$N( \mu = 114, \sigma = 14).$$

```{r}
# Again, don't worry about the syntax here.

ggplot(data.frame(x = c(58, 170)), aes(x)) +
    stat_function(fun = dnorm, args = list(mean = 114, sd = 14)) +
    scale_x_continuous(breaks = c(72, 86, 100, 114, 128, 142, 156))
```


## Predictions using normal models

Using this information, we can estimate the percentage of such women who are expected to have any range of SBP without having access to all such data.

For example, what percentage of women ages 30--44 in the U.S. and Canada are expected to have SBP under 130 mmHg? The `pdist` command from the `mosaic` package will not only help you with this calculation, but it also offers a nice visual representation.

```{r}
pdist("norm", q = 130, mean = 114, sd = 14)
```

The pieces of the `pdist` function are pretty intuitive: `"norm"` (and it has to be in quotes) indicates that we want a normal model, `q` is the value of interest to us, and `mean` and `sd` are self-evident. The output appears below the plot. It gives the area under the curve to the left of our value of interest. In other words, 0.873451, or about 87.3% of women are expected to have SBP less than 130.

If you use this command inline, the pretty picture is not generated, just the value. For example, look at the following sentence both in the R Markdown document and the PDF:

The model predicts that `r 100 * pdist("norm", q = 130, mean = 114, sd = 14)`% of women ages 30--44 in the U.S. and Canada will have systolic blood pressure under 130 mmHg.

(Ignore the ridiculous number of decimal places that R reports. It's a bit of a hassle to try to change it.)

How many women are predicted to have SBP greater than 130? If `r 100 * pdist("norm", q = 130, mean = 114, sd = 14)`% of women have SBP under 130, then `r 100 * (1 - pdist("norm", q = 130, mean = 114, sd = 14))`% must have SBP over 130. Why? Because all women have to add up to 100%!

Therefore, all we have to do to solve this problem is subtract the number we obtained in the previous question from 1. (Remember that 1 = 100%.)

```{r}
1 - pdist("norm", q = 130, mean = 114, sd = 14)
```

The model predicts that `r 100 * (1 - pdist("norm", q = 130, mean = 114, sd = 14))`% of women ages 30--44 in the U.S. and Canada will have systolic blood pressure over 130 mmHg.

Now, here's a more complicated question. What percentage of women are predicted to have SBP between 110 mmHg and 130 mmHg?

Recall that the proportion of women predicted to have SBP less than 130 mmHg was `r pdist("norm", q = 130, mean = 114, sd = 14)`. But this is also counting women with SBP under 110 mmHg, whom we now want to exclude. The proportion of women with SBP under 110 is `r pdist("norm", q = 110, mean = 114, sd = 14)`. All we have to do, then, is subtract `r pdist("norm", q = 110, mean = 114, sd = 14)` from `r pdist("norm", q = 130, mean = 114, sd = 14)`:

```{r}
pdist("norm", q = 130, mean = 114, sd = 14) - pdist("norm", q = 110, mean = 114, sd = 14)
```

Conceptually, this makes sense, but the R code is getting a little bulky, and it also prints both plots, taking up a lot of space. Instead, let's observe that the `pdist` command can include both values (110 and 130):

```{r}
pdist(dist = "norm", q = c(110, 130), mean = 114, sd = 14)
```

The picture looks great and you can see the proportion you desire in the picture in the area between the two lines at 110 and 130. But the output below the plot does not contain the answer to our question. It only shows the percentages below 110 and below 130, respectively. We still have to subtract. However, R can do this for us easily with the `diff` command that we've seen before:

```{r}
diff(pdist(dist = "norm", q = c(110, 130), mean = 114, sd = 14))
```

The model predicts that `r 100 * diff(pdist(dist = "norm", q = c(110, 130), mean = 114, sd = 14))`% of women ages 30--44 in the U.S. and Canada will have systolic blood pressure between 110 mmHg and 130 mmHg.


## Exercises

IQ scores are standardized so that they have a mean of 100 and a standard deviation of 16.

For each of the following questions, use the `pdist` command to draw the right picture and then state your answer in a contextually meaningful full sentence. Don't forget to use the phrase "The model predicts..." and report numbers as percentages, not decimals.

**IMPORTANT:** When you type up your contextually meaningful full sentence responses in the blue answer block, you must type a backslash (not a forward slash) before the percent sign %. If you don't know what a backslash looks like, look here in the R Markdown file:

\

(Markdown actually doesn't allow the backslash to render in the PDF file, so you won't be able to see it if you're looking at the PDF.)

Here is an example:

\begin{answer}
The model predicts that `r 100 * diff(pdist(dist = "norm", q = c(110, 130), mean = 114, sd = 14))`\% of women ages 30--44 in the U.S. and Canada will have systolic blood pressure between 110 mmHg and 130 mmHg.
\end{answer}


### What percentage of people would you expect to have IQ scores over 80?

```{r}
## Add code here to draw the model.
```

\begin{answer}
Please write up your answer here.
\end{answer}

### What percentage of people would you expect to have IQ scores under 90?

```{r}
## Add code here to draw the model.
```

\begin{answer}
Please write up your answer here.
\end{answer}

### What percentage of people would you expect to have IQ scores between 112 and 132?

```{r}
## Add code here to draw the model.
```

\begin{answer}
Please write up your answer here.
\end{answer}

*****


## Percentiles

Often, the question is reversed: instead of getting a value and being asked what percentage of the population falls above or below it, we are given a percentile and asked about the value to which it corresponds.

Here is an example using systolic blood pressure. What is the cutoff value of SBP for the lowest 25% of women ages 30--44 in the U.S. and Canada? In other words, what is the 25th percentile of SBP for this group of women?

The command we need is `qdist`. It looks a lot like `pdist`. Observe:

```{r}
qdist("norm", p = 0.25, mean = 114, sd = 14)
```

The  only change here is that one of the arguments is `p` instead of `q`, and the value of `p` is a proportion (between 0 and 1) instead of a value of SBP. The *output* is now an SBP value.

Here it is inline:

The model predicts that the 25th percentile for SBP in women ages 30--44 in the U.S. and Canada is `r qdist("norm", p = 0.25, mean = 114, sd = 14)` mmHg.

What if we asked about the highest 10% of women? All you have to do is remember that the top 10% is actually the 90th percentile.

```{r}
qdist("norm", p = 0.9, mean = 114, sd = 14)
```

The model predicts that the top 10% of SBP in women ages 30--44 in the U.S. and Canada have SBP higher than `r qdist("norm", p = 0.9, mean = 114, sd = 14)`  mmHg.

Finally, what if we want the middle 50%? This is trickier. The middle 50% lies between the 25th percentile and the 75th percentile. Observe the graph below.

```{r}
qdist("norm", p = c(0.25, 0.75), mean = 114, sd = 14)
```

Therefore, the model predicts that the middle 50% of SBP for women ages 30--44 in the U.S. and Canada lies between `r qdist("norm", p = c(0.25, 0.75), mean = 114, sd = 14)[1]` mmHg and `r qdist("norm", p = c(0.25, 0.75), mean = 114, sd = 14)[2]` mmHg.

We did something tricky in the inline code above. Because the `qdist` command produces two values (one at the 25th percentile and one at the 75th percentile), we can grab each value separately by appending `[1]` or `[2]` to the end of the command.


## Exercises

We'll continue to use IQ scores (mean of 100 and standard deviation of 16).

For each of the following questions, use the `qdist` command to draw the right picture and then state your answer in a contextually meaningful full sentence. Don't forget to use the phrase "The model predicts..."

### What cutoff value bounds the highest 5% of IQ scores?

```{r}
## Add code here to draw the model.
```

\begin{answer}
Please write up your answer here.
\end{answer}

### What cutoff value bounds the lowest 30% of IQ scores?

```{r}
## Add code here to draw the model.
```

\begin{answer}
Please write up your answer here.
\end{answer}

### What cutoff values bound the middle 80% of IQ scores?

```{r}
## Add code here to draw the model.
```

\begin{answer}
Please write up your answer here.
\end{answer}

*****


## Conclusion

The normal model is ubiquitous in statistics, so understanding how to use it to make predictions is critical. When certain assumptions are met (that will be discussed in a future assignment), we can use the normal model to make predictions. Sometimes we have a value and we're interested in calculating a percentage of the population above or below that value. Other times, we want to calculate the value corresponding to a certain percentile. The `pdist` and `qdist` functions are very simple ways of visualizing and calculating using normal models.
